<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint Redirect</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // SharePoint URL 리스트 설정
            const baseUrls = [
                "https://hallagroup.sharepoint.com/:x:/s/00005.10GMN000000204/EX-GjmggDtxBttUfxHSnWAIBQaQiVRGIzHfdE981GC0zLg?e=Vlj6WV",    // IDB1
                "https://hallagroup.sharepoint.com/:x:/s/00005.10GMN000000204/ETduqE6qlNVNigin0ZXngX4B1nEqzvIZjZ-amJLbd0ezQw?e=zuQHol"    // IDB2
            ];

            // URL 파라미터 가져오기
            const urlParams = new URLSearchParams(window.location.search);
            const idx = urlParams.get('i');
            const ver = urlParams.get('v');

            // 디버깅용 콘솔 로그
            console.log('URL Parameters:', urlParams.toString());
            console.log('Ecu:', idx);
            console.log('Ver:', ver);
            console.log('baseUrls Length:', baseUrls.length);

            // 기본값 설정 및 유효성 검사
            redirectUrl = (idx >= 0 && idx < baseUrls.length) ? baseUrls[idx] : baseUrls[0];

            console.log('Redirect URL:', redirectUrl);

            // ActiveCell 파라미터 추가
            if (ver) {
                console.log('test')
                redirectUrl += `&ActiveCell=${encodeURIComponent(ver)}!A1`;
                console.log('test')
            }

            // 디버깅용 콘솔 로그
            console.log('Redirect URL:', redirectUrl);

            // 리디렉션 수행
            window.location.href = redirectUrl;
        });
    </script>
</head>
<body>
    <p>Redirecting to SharePoint...</p>
</body>
</html>
